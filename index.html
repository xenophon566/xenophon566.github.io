<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT" crossorigin="anonymous"></script>
    <script src="./json-editor/src/JSONedtr.js"></script>
    <link rel="stylesheet" href="./json-editor/src/JSONedtr.css">
    <title>iFrame</title>
</head>

<body>
    <div style="border: 2px dashed rgb(158, 158, 158); padding: 2rem;">
        <div>你剛才傳入的是 :
            <span id="result"></span>
            <div id="one" style="display: none;"></div>
        </div>
        <button onClick="getDataString()">打印 Console</button>
        <button onClick="postMsg()">傳回主頁</button>
    </div>

    <div>解譯畫面如下</div>
    <div id="output"></div>
</body>
<script>
    $(function() {
        var one = null;

        window.onmessage = function(e) {
            if (!!e.data) {
                console.log('%c你剛才傳入的是 : ' + e.data, 'font-size: 16px');
                $("#result").html(e.data);

                // 資料填入 JSON編輯器
                var one = new JSONedtr(e.data, '#output', { runFunctionOnUpdate: 'getDataOnChange', instantChange: true });
            }
        }
    });

    function getDataOnChange(data) {
        $('#one').html(data.getDataString());
        // console.log('資料編輯中', data.getData());
    }

    function getDataString() {
        var result2 = $('#one').html();
        console.log('%c打印目前資料 : ' + result2, 'font-size: 16px');
    }

    function postMsg() {
        parent.window.postMessage($('#one').html(), '*');
        console.log('%c完成交互了', 'font-size: 16px');
    }
</script>

</html>
